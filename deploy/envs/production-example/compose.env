# ══════════════════════════════════════════════════════════════════════════════
#  Docker Compose Variables — Production
# ══════════════════════════════════════════════════════════════════════════════
#
#  Variables consumed by docker-compose via ${VAR} interpolation.
#  Shared across services (database, storage, frontend, etc.).
#
#  Setup:
#    cp -r deploy/envs/production-example deploy/envs/production
#    # Fill in ALL required values
#    ./deploy/up.sh production up -d
#
#  Every required variable is marked with "REQUIRED". All others have sensible
#  defaults or are optional. Never commit the production/ directory.
#
# ══════════════════════════════════════════════════════════════════════════════

# ── Docker Images (REQUIRED) ─────────────────────────────────────────────────
# Full image references including registry and tag.
# Built and pushed by: ./deploy/build.sh
API_IMAGE=registry.example.com/myapp-api:0.1.0
FRONTEND_IMAGE=registry.example.com/myapp-frontend:0.1.0

# ── Database (REQUIRED) ──────────────────────────────────────────────────────
POSTGRES_USER=<db-username>
POSTGRES_PASSWORD=<strong-random-password>
# POSTGRES_DB=myapp

# ── File Storage (MinIO / S3) ────────────────────────────────────────────────
# S3-compatible credentials. For the bundled MinIO container these double as
# MINIO_ROOT_USER / MINIO_ROOT_PASSWORD. For external S3 (AWS, Cloudflare R2,
# DigitalOcean Spaces, etc.) set these to your provider's access/secret keys.
MINIO_ROOT_USER=<access-key>
MINIO_ROOT_PASSWORD=<secret-key>
FileStorage__BucketName=<your-bucket-name>
# Uncomment and adjust when using external S3 instead of the bundled MinIO:
# FileStorage__Endpoint=https://s3.amazonaws.com
# FileStorage__Region=us-east-1
# FileStorage__UseSSL=true

# ── Authentication (REQUIRED) ────────────────────────────────────────────────
# Minimum 32 characters. Generate with: openssl rand -base64 64 | tr -d '\n/+=' | cut -c1-64
JWT_SECRET_KEY=<strong-random-secret-at-least-32-chars>

# ── CAPTCHA (Cloudflare Turnstile) ──────────────────────────────────────────
# Site key (public, passed to frontend at runtime):
TURNSTILE_SITE_KEY=<your-turnstile-site-key>

# ── Frontend ─────────────────────────────────────────────────────────────────
# URL the frontend container uses to reach the backend API (internal network).
# Default http://api:8080 works when both containers are on the same compose network.
# API_URL=http://api:8080

# Trusted reverse proxy hops for SvelteKit's getClientAddress().
# Set to 1 if behind nginx/Caddy, 2 if behind a cloud LB + nginx, etc.
XFF_DEPTH=1

# Additional origins for SvelteKit API proxy CSRF check (comma-separated).
# Usually not needed in production if the app is served from a single domain.
# ALLOWED_ORIGINS=

# ── Ports ────────────────────────────────────────────────────────────────────
# Host ports for the API and frontend. Typically fronted by a reverse proxy
# that terminates TLS (e.g. nginx, Caddy, Traefik).
# API_PORT=8080
# FRONTEND_PORT=3000

# ── SvelteKit Origin (REQUIRED) ─────────────────────────────────────────────
# Required when behind a TLS-terminating reverse proxy so SvelteKit generates
# correct URLs and validates CSRF origins. Set to your public domain.
ORIGIN=https://your-domain.com
